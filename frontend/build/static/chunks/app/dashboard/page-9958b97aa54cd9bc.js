(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{2274:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>V});var o=t(5155),i=t(2115),n=t(6324),s=t(7943),l=t(4581),a=t(4426),c=t(1169),d=t(529),x=t(2663),h=t(1116),g=t(3127),b=t(6564),p=t(7217),f=t(1803),m=t(1218),u=t(6632),A=t(2302),j=t(8407),y=t(1101),w=t(3010),v=t(6278),k=t(4492),C=t(9927),S=t(1977),I=t(8534),z=t(8387),W=t(335),E=t(4802),P=t(3290),T=t(5808),L=t(250),O=t(9839),D=t(3196),R=t(5297),H=t(4186),N=t(2502),F=t(9584),G=t(8674),_=t(8890),Y=t(5695);let B=e=>{let{ticket:r,onEdit:t,onView:i}=e,n={open:{color:"#3b82f6",bgcolor:"#dbeafe",label:"Open"},"in progress":{color:"#f59e0b",bgcolor:"#fef3c7",label:"In Progress"},closed:{color:"#10b981",bgcolor:"#d1fae5",label:"Closed"}},s={high:{color:"#dc2626",bgcolor:"#fee2e2",icon:H.A,label:"High Priority"},medium:{color:"#ea580c",bgcolor:"#fed7aa",icon:N.A,label:"Medium Priority"},low:{color:"#16a34a",bgcolor:"#dcfce7",icon:F.A,label:"Low Priority"}},a=n[r.status.toLowerCase()]||n.open,c=s[r.priority.toLowerCase()]||s.medium,d=c.icon,b=(0,Y.useRouter)();return(0,o.jsx)(m.A,{onClick:()=>b.push("/tickets/".concat(r.id)),sx:{transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer",borderRadius:3,border:"1px solid",borderColor:"divider","&:hover":{transform:"translateY(-4px)",boxShadow:"0 20px 25px -5px rgb(0 0 0 / 0.1), 0 10px 10px -5px rgb(0 0 0 / 0.04)",borderColor:a.color}},children:(0,o.jsxs)(u.A,{sx:{p:3},children:[(0,o.jsxs)(f.A,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:2},children:[(0,o.jsx)(y.A,{label:a.label,size:"small",sx:{bgcolor:a.bgcolor,color:a.color,fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em"}}),(0,o.jsx)(R.A,{title:c.label,children:(0,o.jsx)(x.A,{sx:{width:32,height:32,bgcolor:c.bgcolor,color:c.color},children:(0,o.jsx)(d,{sx:{fontSize:18}})})})]}),(0,o.jsx)(h.A,{variant:"h6",component:"h3",sx:{fontWeight:700,color:"text.primary",mb:1,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",lineHeight:1.3},children:r.title}),(0,o.jsx)(h.A,{variant:"body2",color:"text.secondary",sx:{mb:3,display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden",lineHeight:1.5,minHeight:"3.6em"},children:r.description}),(0,o.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pt:2,borderTop:"1px solid",borderColor:"divider"},children:[(0,o.jsxs)(l.A,{display:"flex",alignItems:"center",children:[(0,o.jsx)(W.A,{sx:{fontSize:16,color:"text.secondary",mr:.5}}),(0,o.jsx)(h.A,{variant:"caption",color:"text.secondary",children:(e=>{let r=new Date(e),t=new Date,o=Math.ceil(Math.abs(t.getTime()-r.getTime())/864e5);return 1===o?"Yesterday":o<7?"".concat(o," days ago"):r.toLocaleDateString("en-US",{month:"short",day:"numeric",year:r.getFullYear()!==t.getFullYear()?"numeric":void 0})})(r.createdAt)})]}),(0,o.jsxs)(f.A,{direction:"row",spacing:.5,children:[i&&(0,o.jsx)(R.A,{title:"View Details",children:(0,o.jsx)(g.A,{size:"small",onClick:e=>{e.stopPropagation(),i(r)},sx:{color:"text.secondary","&:hover":{color:"primary.main",bgcolor:"primary.50"}},children:(0,o.jsx)(G.A,{sx:{fontSize:18}})})}),t&&(0,o.jsx)(R.A,{title:"Edit Ticket",children:(0,o.jsx)(g.A,{size:"small",onClick:e=>{e.stopPropagation(),t(r)},sx:{color:"text.secondary","&:hover":{color:"secondary.main",bgcolor:"secondary.50"}},children:(0,o.jsx)(_.A,{sx:{fontSize:18}})})})]})]}),(0,o.jsx)(l.A,{sx:{position:"absolute",top:8,right:8,bgcolor:"rgba(0, 0, 0, 0.04)",borderRadius:1,px:1,py:.25},children:(0,o.jsxs)(h.A,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem"},children:["#",r.id]})})]})})};var M=t(9576);let J=(0,O.A)({palette:{primary:{main:"#6366f1",light:"#818cf8",dark:"#4f46e5"},secondary:{main:"#ec4899",light:"#f472b6",dark:"#db2777"},success:{main:"#10b981",light:"#34d399",dark:"#059669"},warning:{main:"#f59e0b",light:"#fbbf24",dark:"#d97706"},background:{default:"#f8fafc",paper:"#ffffff"}},typography:{fontFamily:'"Inter", "Roboto", "Helvetica", "Arial", sans-serif',h4:{fontWeight:700},h6:{fontWeight:600}},shape:{borderRadius:12},components:{MuiCard:{styleOverrides:{root:{boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)",transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)"}}}}}}),U={open:{label:"Open",color:"#3b82f6",icon:z.A,bgGradient:"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)"},"in progress":{label:"In Progress",color:"#f59e0b",icon:W.A,bgGradient:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)"},closed:{label:"Closed",color:"#10b981",icon:E.A,bgGradient:"linear-gradient(135deg, #10b981 0%, #059669 100%)"}};function V(){let[e,r]=(0,i.useState)([]),[t,O]=(0,i.useState)(""),[R,H]=(0,i.useState)(!0),[N,F]=(0,i.useState)(!1),[G,_]=(0,i.useState)(""),[V,q]=(0,i.useState)(!1),{token:K,logout:Q}=(0,M.A)(),X=(0,Y.useRouter)(),Z=(0,n.A)(),$=(0,s.A)(Z.breakpoints.down("md"));(0,i.useEffect)(()=>{K||X.push("/login")},[K,X]),(0,i.useEffect)(()=>{let e=async()=>{let e=localStorage.getItem("token");H(!0);try{let t=await fetch("".concat("https://aetherdesk.onrender.com/","tickets"),{headers:{Authorization:"Bearer ".concat(e)}}),o=await t.json();t.ok?r(o.tickets):O(o.error||"Failed to fetch tickets")}catch(e){O("An error occurred while fetching tickets."),console.error(e)}finally{H(!1)}};K&&e()},[K]),(0,i.useEffect)(()=>{(async()=>{if(!N)return;let e=localStorage.getItem("token");q(!0);try{let r=await fetch("".concat("https://aetherdesk.onrender.com/","ai/summary"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(!r.ok){let e=await r.json();throw Error(e.error||"Failed to fetch summary")}let t=await r.json();_(t.summary||"No summary available.")}catch(e){_("Failed to load AI summary."),console.error("Error fetching AI summary:",e)}finally{q(!1)}})()},[N]);let ee={total:e.length,open:e.filter(e=>"open"===e.status.toLowerCase()).length,inProgress:e.filter(e=>"in progress"===e.status.toLowerCase()).length,closed:e.filter(e=>"closed"===e.status.toLowerCase()).length};return K?(0,o.jsx)(D.A,{theme:J,children:(0,o.jsxs)(l.A,{sx:{flexGrow:1,minHeight:"100vh",bgcolor:"background.default"},children:[(0,o.jsx)(c.A,{position:"sticky",sx:{background:"linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #ec4899 100%)",boxShadow:"0 4px 20px rgba(99, 102, 241, 0.3)"},children:(0,o.jsxs)(d.A,{children:[(0,o.jsx)(x.A,{sx:{mr:2,bgcolor:"rgba(255,255,255,0.2)"},children:(0,o.jsx)(z.A,{})}),(0,o.jsx)(h.A,{variant:"h6",component:"div",sx:{flexGrow:1,fontWeight:700},children:"Ticket Dashboard"}),(0,o.jsx)(g.A,{color:"inherit",sx:{mr:1},children:(0,o.jsx)(b.A,{badgeContent:ee.open,color:"error",children:(0,o.jsx)(P.A,{})})}),(0,o.jsx)(g.A,{color:"inherit",onClick:Q,children:(0,o.jsx)(T.A,{})})]})}),(0,o.jsxs)(p.A,{maxWidth:"xl",sx:{py:4},children:[(0,o.jsxs)(f.A,{direction:$?"column":"row",spacing:3,sx:{mb:4},children:[(0,o.jsx)(m.A,{sx:{flex:1,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:(0,o.jsx)(u.A,{children:(0,o.jsxs)(l.A,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,o.jsxs)(l.A,{children:[(0,o.jsx)(h.A,{variant:"h4",component:"div",fontWeight:"bold",children:ee.total}),(0,o.jsx)(h.A,{variant:"body2",sx:{opacity:.9},children:"Total Tickets"})]}),(0,o.jsx)(x.A,{sx:{bgcolor:"rgba(255,255,255,0.2)",width:56,height:56},children:(0,o.jsx)(z.A,{fontSize:"large"})})]})})}),(0,o.jsx)(m.A,{sx:{flex:1,background:"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)",color:"white"},children:(0,o.jsx)(u.A,{children:(0,o.jsxs)(l.A,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,o.jsxs)(l.A,{children:[(0,o.jsx)(h.A,{variant:"h4",component:"div",fontWeight:"bold",children:ee.open}),(0,o.jsx)(h.A,{variant:"body2",sx:{opacity:.9},children:"Open Tickets"})]}),(0,o.jsx)(x.A,{sx:{bgcolor:"rgba(255,255,255,0.2)",width:56,height:56},children:(0,o.jsx)(L.A,{fontSize:"large"})})]})})}),(0,o.jsx)(m.A,{sx:{flex:1,background:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",color:"white"},children:(0,o.jsx)(u.A,{children:(0,o.jsxs)(l.A,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,o.jsxs)(l.A,{children:[(0,o.jsx)(h.A,{variant:"h4",component:"div",fontWeight:"bold",children:ee.inProgress}),(0,o.jsx)(h.A,{variant:"body2",sx:{opacity:.9},children:"In Progress"})]}),(0,o.jsx)(x.A,{sx:{bgcolor:"rgba(255,255,255,0.2)",width:56,height:56},children:(0,o.jsx)(W.A,{fontSize:"large"})})]})})}),(0,o.jsx)(m.A,{sx:{flex:1,background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",color:"white"},children:(0,o.jsx)(u.A,{children:(0,o.jsxs)(l.A,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,o.jsxs)(l.A,{children:[(0,o.jsx)(h.A,{variant:"h4",component:"div",fontWeight:"bold",children:ee.closed}),(0,o.jsx)(h.A,{variant:"body2",sx:{opacity:.9},children:"Closed Tickets"})]}),(0,o.jsx)(x.A,{sx:{bgcolor:"rgba(255,255,255,0.2)",width:56,height:56},children:(0,o.jsx)(E.A,{fontSize:"large"})})]})})})]}),t&&(0,o.jsx)(A.A,{severity:"error",sx:{mb:3,borderRadius:2},children:t}),R?(0,o.jsx)(l.A,{display:"flex",justifyContent:"center",alignItems:"center",py:8,children:(0,o.jsx)(a.A,{size:60})}):(0,o.jsx)(f.A,{direction:$?"column":"row",spacing:3,sx:{alignItems:"flex-start"},children:Object.entries(U).map(r=>{let[t,i]=r,n=e.filter(e=>e.status.toLowerCase()===t),s=i.icon;return(0,o.jsx)(l.A,{sx:{flex:1,width:"100%",minWidth:$?"100%":"300px"},children:(0,o.jsxs)(j.A,{elevation:0,sx:{p:2,minHeight:"600px",bgcolor:"background.paper",border:"1px solid",borderColor:"divider",borderRadius:3},children:[(0,o.jsxs)(l.A,{sx:{background:i.bgGradient,borderRadius:2,p:2,mb:3,color:"white",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,o.jsxs)(l.A,{display:"flex",alignItems:"center",children:[(0,o.jsx)(s,{sx:{mr:1}}),(0,o.jsx)(h.A,{variant:"h6",fontWeight:"bold",children:i.label})]}),(0,o.jsx)(y.A,{label:n.length,size:"small",sx:{bgcolor:"rgba(255,255,255,0.2)",color:"white",fontWeight:"bold"}})]}),(0,o.jsx)(f.A,{spacing:2,children:0===n.length?(0,o.jsxs)(l.A,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",py:6,sx:{opacity:.6},children:[(0,o.jsx)(s,{sx:{fontSize:48,mb:2,color:i.color}}),(0,o.jsxs)(h.A,{variant:"body1",color:"text.secondary",children:["No ",i.label.toLowerCase()," tickets"]})]}):n.map(e=>(0,o.jsx)(B,{ticket:e},e.id))})]})},t)})})]}),(0,o.jsx)(w.A,{color:"secondary","aria-label":"ai summary",sx:{position:"fixed",bottom:24,right:24,background:"linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%)","&:hover":{background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)"}},onClick:()=>F(!0),children:(0,o.jsx)(L.A,{})}),(0,o.jsxs)(v.A,{open:N,onClose:()=>F(!1),fullWidth:!0,maxWidth:"md",children:[(0,o.jsx)(k.A,{children:"\uD83E\uDDE0 AI Ticket Summary"}),(0,o.jsx)(C.A,{dividers:!0,sx:{whiteSpace:"pre-wrap",fontSize:"0.95rem"},children:V?(0,o.jsx)(l.A,{display:"flex",alignItems:"center",justifyContent:"center",py:4,children:(0,o.jsx)(a.A,{})}):(0,o.jsx)(h.A,{variant:"body1",children:G})}),(0,o.jsx)(S.A,{children:(0,o.jsx)(I.A,{onClick:()=>F(!1),color:"primary",children:"Close"})})]})]})}):(0,o.jsx)(D.A,{theme:J,children:(0,o.jsx)(l.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",bgcolor:"background.default",children:(0,o.jsx)(a.A,{size:60})})})}},9112:(e,r,t)=>{Promise.resolve().then(t.bind(t,2274))},9576:(e,r,t)=>{"use strict";t.d(r,{A:()=>l,AuthProvider:()=>s});var o=t(5155),i=t(2115);let n=(0,i.createContext)(void 0);function s(e){let{children:r}=e,[t,s]=(0,i.useState)(null),[l,a]=(0,i.useState)(null);return(0,i.useEffect)(()=>{let e=localStorage.getItem("token"),r=localStorage.getItem("user");if(e&&s(e),r)try{a(JSON.parse(r))}catch(e){console.error("Error parsing saved user data:",e),localStorage.removeItem("user")}},[]),(0,o.jsx)(n.Provider,{value:{token:t,user:l,setToken:e=>{s(e),e?localStorage.setItem("token",e):localStorage.removeItem("token")},setUser:e=>{a(e),e?localStorage.setItem("user",JSON.stringify(e)):localStorage.removeItem("user")},logout:()=>{s(null),a(null),localStorage.removeItem("token"),localStorage.removeItem("user")}},children:r})}function l(){let e=(0,i.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{var r=r=>e(e.s=r);e.O(0,[936,712,735,441,684,358],()=>r(9112)),_N_E=e.O()}]);