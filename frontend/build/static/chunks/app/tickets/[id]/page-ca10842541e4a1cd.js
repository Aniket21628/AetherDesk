(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[266],{1228:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>M});var o=t(5155),i=t(2115),s=t(5695),n=t(4581),a=t(7217),c=t(7775),l=t(1218),d=t(6632),h=t(2302),x=t(8534),u=t(431),g=t(1960),b=t(1116),A=t(4962),m=t(1803),j=t(3127),p=t(1101),f=t(4964),y=t(8407),v=t(2663),k=t(9816),w=t(7348),S=t(1346),I=t(7894),C=t(4426),W=t(5726),z=t(4103),P=t(7713),D=t(4802),R=t(4186),O=t(2502),E=t(9584),H=t(8464),T=t(8890),U=t(4341),N=t(335),_=t(1935),L=t(9839),B=t(3196),F=t(9576);let J=(0,L.A)({palette:{primary:{main:"#6366f1",light:"#818cf8",dark:"#4f46e5"},secondary:{main:"#ec4899",light:"#f472b6",dark:"#db2777"},success:{main:"#10b981",light:"#34d399",dark:"#059669"},warning:{main:"#f59e0b",light:"#fbbf24",dark:"#d97706"},background:{default:"#f8fafc",paper:"#ffffff"}},typography:{fontFamily:'"Inter", "Roboto", "Helvetica", "Arial", sans-serif'},shape:{borderRadius:12}});function M(){let{id:e}=(0,s.useParams)(),r=(0,s.useRouter)(),{token:t}=(0,F.A)(),[L,M]=(0,i.useState)(null),[q,G]=(0,i.useState)(""),[K,Q]=(0,i.useState)(""),[V,X]=(0,i.useState)(!0),[Y,Z]=(0,i.useState)(!1),[$,ee]=(0,i.useState)(!1),er={open:{label:"Open",color:"#3b82f6",bgcolor:"#dbeafe",icon:z.A},"in progress":{label:"In Progress",color:"#f59e0b",bgcolor:"#fef3c7",icon:P.A},closed:{label:"Closed",color:"#10b981",bgcolor:"#d1fae5",icon:D.A}},et={high:{label:"High Priority",color:"#dc2626",bgcolor:"#fee2e2",icon:R.A},medium:{label:"Medium Priority",color:"#ea580c",bgcolor:"#fed7aa",icon:O.A},low:{label:"Low Priority",color:"#16a34a",bgcolor:"#dcfce7",icon:E.A}};(0,i.useEffect)(()=>{if(!t)return void r.push("/login");(async()=>{X(!0);try{let r=await fetch("".concat("https://aetherdesk.onrender.com/","tickets/").concat(e),{headers:{Authorization:"Bearer ".concat(t)}}),o=await r.json();r.ok?(M(o.ticket),G(o.ticket.status)):Q(o.error||"Failed to fetch ticket")}catch(e){Q("Something went wrong while fetching the ticket"),console.error(e)}finally{X(!1)}})()},[e,t,r]);let eo=async()=>{if(t){Z(!0);try{let r=await fetch("".concat("https://aetherdesk.onrender.com/","tickets/").concat(e,"/status"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({status:q})}),o=await r.json();r.ok?(M(o.ticket),ee(!0)):Q(o.error||"Failed to update status")}catch(e){Q("Something went wrong while updating the ticket"),console.error(e)}finally{Z(!1)}}},ei=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});if(V)return(0,o.jsx)(B.A,{theme:J,children:(0,o.jsx)(n.A,{sx:{bgcolor:"background.default",minHeight:"100vh",py:4},children:(0,o.jsxs)(a.A,{maxWidth:"md",children:[(0,o.jsx)(c.A,{variant:"rectangular",height:60,sx:{mb:3,borderRadius:2}}),(0,o.jsx)(l.A,{sx:{borderRadius:3},children:(0,o.jsxs)(d.A,{sx:{p:4},children:[(0,o.jsx)(c.A,{variant:"text",height:40,width:"60%",sx:{mb:2}}),(0,o.jsx)(c.A,{variant:"text",height:20,width:"100%",sx:{mb:1}}),(0,o.jsx)(c.A,{variant:"text",height:20,width:"80%",sx:{mb:3}}),(0,o.jsx)(c.A,{variant:"rectangular",height:120,sx:{borderRadius:2}})]})})]})})});if(K)return(0,o.jsx)(B.A,{theme:J,children:(0,o.jsx)(n.A,{sx:{bgcolor:"background.default",minHeight:"100vh",py:4},children:(0,o.jsx)(a.A,{maxWidth:"md",children:(0,o.jsx)(h.A,{severity:"error",sx:{borderRadius:2},action:(0,o.jsx)(x.A,{color:"inherit",size:"small",onClick:()=>r.push("/dashboard"),children:"Back to Dashboard"}),children:K})})})});if(!L)return null;let es=er[L.status.toLowerCase()]||er.open,en=et[L.priority.toLowerCase()]||et.medium,ea=es.icon,ec=en.icon;return(0,o.jsx)(B.A,{theme:J,children:(0,o.jsx)(n.A,{sx:{bgcolor:"background.default",minHeight:"100vh",py:4},children:(0,o.jsxs)(a.A,{maxWidth:"md",children:[(0,o.jsxs)(u.A,{sx:{mb:3},children:[(0,o.jsxs)(g.A,{component:"button",variant:"body2",onClick:()=>r.push("/dashboard"),sx:{display:"flex",alignItems:"center",textDecoration:"none",color:"primary.main","&:hover":{textDecoration:"underline"}},children:[(0,o.jsx)(H.A,{sx:{mr:.5,fontSize:16}}),"Dashboard"]}),(0,o.jsxs)(b.A,{variant:"body2",color:"text.primary",children:["Ticket #",L.id]})]}),(0,o.jsx)(A.A,{in:!0,timeout:600,children:(0,o.jsx)(l.A,{sx:{borderRadius:3,boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)"},children:(0,o.jsxs)(d.A,{sx:{p:4},children:[(0,o.jsxs)(m.A,{direction:"row",justifyContent:"space-between",alignItems:"flex-start",sx:{mb:3},children:[(0,o.jsxs)(n.A,{children:[(0,o.jsx)(b.A,{variant:"h4",component:"h1",sx:{fontWeight:700,color:"text.primary",mb:1},children:L.title}),(0,o.jsxs)(b.A,{variant:"body2",color:"text.secondary",children:["Ticket #",L.id]})]}),(0,o.jsx)(j.A,{color:"primary",sx:{bgcolor:"primary.50","&:hover":{bgcolor:"primary.100"}},children:(0,o.jsx)(T.A,{})})]}),(0,o.jsxs)(m.A,{direction:"row",spacing:2,sx:{mb:3},children:[(0,o.jsx)(p.A,{icon:(0,o.jsx)(ea,{}),label:es.label,sx:{bgcolor:es.bgcolor,color:es.color,fontWeight:600,"& .MuiChip-icon":{color:es.color}}}),(0,o.jsx)(p.A,{icon:(0,o.jsx)(ec,{}),label:en.label,sx:{bgcolor:en.bgcolor,color:en.color,fontWeight:600,"& .MuiChip-icon":{color:en.color}}})]}),(0,o.jsx)(f.A,{sx:{my:3}}),(0,o.jsxs)(n.A,{sx:{mb:4},children:[(0,o.jsx)(b.A,{variant:"h6",sx:{fontWeight:600,mb:2},children:"Description"}),(0,o.jsx)(y.A,{elevation:0,sx:{p:3,bgcolor:"grey.50",borderRadius:2,border:"1px solid",borderColor:"grey.200"},children:(0,o.jsx)(b.A,{variant:"body1",sx:{lineHeight:1.7},children:L.description})})]}),(0,o.jsxs)(n.A,{sx:{mb:4},children:[(0,o.jsx)(b.A,{variant:"h6",sx:{fontWeight:600,mb:2},children:"Ticket Details"}),(0,o.jsxs)(m.A,{spacing:2,children:[(0,o.jsxs)(m.A,{direction:"row",alignItems:"center",spacing:2,children:[(0,o.jsx)(v.A,{sx:{bgcolor:"primary.100",color:"primary.main",width:32,height:32},children:(0,o.jsx)(U.A,{sx:{fontSize:16}})}),(0,o.jsxs)(n.A,{children:[(0,o.jsx)(b.A,{variant:"body2",color:"text.secondary",children:"Created"}),(0,o.jsx)(b.A,{variant:"body1",fontWeight:500,children:ei(L.createdAt)})]})]}),L.updatedAt&&(0,o.jsxs)(m.A,{direction:"row",alignItems:"center",spacing:2,children:[(0,o.jsx)(v.A,{sx:{bgcolor:"secondary.100",color:"secondary.main",width:32,height:32},children:(0,o.jsx)(N.A,{sx:{fontSize:16}})}),(0,o.jsxs)(n.A,{children:[(0,o.jsx)(b.A,{variant:"body2",color:"text.secondary",children:"Last Updated"}),(0,o.jsx)(b.A,{variant:"body1",fontWeight:500,children:ei(L.updatedAt)})]})]})]})]}),(0,o.jsx)(f.A,{sx:{my:3}}),(0,o.jsxs)(n.A,{sx:{mb:3},children:[(0,o.jsx)(b.A,{variant:"h6",sx:{fontWeight:600,mb:2},children:"Update Status"}),(0,o.jsxs)(m.A,{direction:"row",spacing:2,alignItems:"center",children:[(0,o.jsxs)(k.A,{sx:{minWidth:200},children:[(0,o.jsx)(w.A,{children:"Status"}),(0,o.jsxs)(S.A,{value:q,label:"Status",onChange:e=>G(e.target.value),disabled:Y,children:[(0,o.jsx)(I.A,{value:"open",children:(0,o.jsxs)(m.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,o.jsx)(z.A,{sx:{fontSize:16,color:er.open.color}}),(0,o.jsx)("span",{children:"Open"})]})}),(0,o.jsx)(I.A,{value:"in progress",children:(0,o.jsxs)(m.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,o.jsx)(P.A,{sx:{fontSize:16,color:er["in progress"].color}}),(0,o.jsx)("span",{children:"In Progress"})]})}),(0,o.jsx)(I.A,{value:"closed",children:(0,o.jsxs)(m.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,o.jsx)(D.A,{sx:{fontSize:16,color:er.closed.color}}),(0,o.jsx)("span",{children:"Closed"})]})})]})]}),(0,o.jsx)(x.A,{variant:"contained",onClick:eo,disabled:Y||q===L.status,startIcon:Y?(0,o.jsx)(C.A,{size:16}):(0,o.jsx)(_.A,{}),sx:{background:"linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)","&:hover":{background:"linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%)"}},children:Y?"Updating...":"Update Status"})]})]}),(0,o.jsx)(m.A,{direction:"row",spacing:2,sx:{pt:2},children:(0,o.jsx)(x.A,{variant:"outlined",startIcon:(0,o.jsx)(H.A,{}),onClick:()=>r.push("/dashboard"),sx:{borderRadius:2},children:"Back to Dashboard"})})]})})}),(0,o.jsx)(W.A,{open:$,autoHideDuration:3e3,onClose:()=>ee(!1),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,o.jsx)(h.A,{onClose:()=>ee(!1),severity:"success",sx:{width:"100%"},children:"Ticket status updated successfully!"})})]})})})}},2474:(e,r,t)=>{Promise.resolve().then(t.bind(t,1228))},9576:(e,r,t)=>{"use strict";t.d(r,{A:()=>a,AuthProvider:()=>n});var o=t(5155),i=t(2115);let s=(0,i.createContext)(void 0);function n(e){let{children:r}=e,[t,n]=(0,i.useState)(null),[a,c]=(0,i.useState)(null);return(0,i.useEffect)(()=>{let e=localStorage.getItem("token"),r=localStorage.getItem("user");if(e&&n(e),r)try{c(JSON.parse(r))}catch(e){console.error("Error parsing saved user data:",e),localStorage.removeItem("user")}},[]),(0,o.jsx)(s.Provider,{value:{token:t,user:a,setToken:e=>{n(e),e?localStorage.setItem("token",e):localStorage.removeItem("token")},setUser:e=>{c(e),e?localStorage.setItem("user",JSON.stringify(e)):localStorage.removeItem("user")},logout:()=>{n(null),c(null),localStorage.removeItem("token"),localStorage.removeItem("user")}},children:r})}function a(){let e=(0,i.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{var r=r=>e(e.s=r);e.O(0,[936,835,712,75,441,684,358],()=>r(2474)),_N_E=e.O()}]);